@(data: models.DisposeViewModel,
        disposeForm: Form[models.DisposeFormModel],
        dateService: uk.gov.dvla.vehicles.presentation.common.services.DateService)(implicit lang: Lang,
        token: uk.gov.dvla.vehicles.presentation.common.filters.CsrfPreventionAction.CsrfPreventionToken,
        config: utils.helpers.Config)

@import models.DisposeFormModel.Form.BackId
@import models.DisposeFormModel.Form.ConsentId
@import models.DisposeFormModel.Form.DateOfDisposalId
@import models.DisposeFormModel.Form.DateOfDisposalYearsIntoThePast
@import models.DisposeFormModel.Form.LossOfRegistrationConsentId
@import models.DisposeFormModel.Form.MileageId
@import models.DisposeFormModel.Form.SubmitId
@import models.DisposeFormModel.Form.TodaysDateOfDisposal
@import views.html.disposal_of_vehicle.main
@import uk.gov.dvla.vehicles.presentation.common
@import common.mappings.Mileage
@import common.views.helpers.BaseTemplate.fieldConstructor
@import common.views.html.widgets.base.valtechDeclareCheck
@import common.views.html.widgets.base.valtechInputText
@import common.views.html.widgets.dates.inputDayMonthYearTextbox
@import common.views.html.widgets.base.csrfTokenHiddenField
@import views.html.helper.form

@main(
    progress = Some(Messages("disposal_progress_5")),
    title = Messages("disposal_dispose.title"),
    currentForm = Some(disposeForm)
) {
    @form(action = controllers.routes.Dispose.submit()) {
        @csrfTokenHiddenField()
        
        <script src="@routes.Assets.at("lib/vehicles-presentation-common/javascripts/autofill-todays-date.js")" type="text/javascript"></script>

        <div class="two-col clearfix">

            <div class="disposal-info first-col">
                <dl class="playback">
                    <dt><h2>@Messages("disposal_dispose.vehicledetails")</h2></dt>
                    <dt>@Messages("disposal_dispose.vehiclereg")</dt>
                    <dd>@data.registrationNumber</dd>
                    <dt>@Messages("disposal_dispose.vehiclemake")</dt>
                    <dd>@data.vehicleMake</dd>
                    <dt>@Messages("disposal_dispose.vehiclemodel")</dt>
                    <dd>@data.vehicleModel</dd>
                </dl>

                <div class="alert-warning">
                    <p>@Messages("disposal_dispose.warning")</p>
                </div>
            </div>


            <div class="disposal-form second-col uppercase-input">
                <h2>@Messages("disposal_dispose.disposevehicleto")</h2>

                <div class="playback">
                    <p>@data.dealerName <br />
                        @for(addr <- data.dealerAddress) {@addr<br/>}</p>
                </div>

                @valtechDeclareCheck(disposeForm(ConsentId),
                    args = Map(
                        '_showConstraints -> false,
                        'autofocus -> true,
                        '_label -> Messages("disposal_dispose.consent")
                    )
                )

                @valtechDeclareCheck(disposeForm(LossOfRegistrationConsentId),
                    args = Map(
                        '_showConstraints -> false,
                        '_label -> Messages("disposal_dispose.loss_of_registration.consent")
                    )
                )

                @valtechInputText(disposeForm(MileageId), args =
                    Map('_label -> Messages("disposal_dispose.mileage.label"),
                        '_showConstraints -> false,
                        'typeTel -> true,
                        'maxLength -> Mileage.MaxLength // Must be set independently of the pattern as the pattern is only checked when the user submits.
                        //'title -> Messages("disposal_dispose.mileage.validation")
                        ) ++
                        (if(config.isHtml5ValidationEnabled) Map('pattern -> Mileage.Pattern) else Nil)
                )

                <div id=@DateOfDisposalId>
                @inputDayMonthYearTextbox(
                    field =disposeForm(DateOfDisposalId),
                    args = Map(
                        '_label -> Messages("disposal_dispose.dateofdisposal.label"),
                        'autofocus -> true
                    ),
                    dateService = dateService,
                    showTodaysDateButton = true,
                    showTodaysDateButtonId = Some(TodaysDateOfDisposal),
                    hintText = Some(Messages("disposal_dispose.dateofdisposal.hint"))
                )
                </div>

                @{
                    /* Note primary button moved to first button as per https://www.gov.uk/service-manual/user-centered-design/resources/forms.html#buttons */
                }
                <div class="form-steps">
                    <button id="@SubmitId" type="submit" name="action" class="button">@Messages("disposal_dispose.submitbutton")</button>
                    <br/>
                    <a class="back" id="@BackId" href="@controllers.routes.VehicleLookup.present()">@Messages("disposal_dispose.backbutton")</a>

                    <div class="two-col-spacer">
                    </div>
                </div>
            </div>
        </div>
    }

    <script src="@routes.Assets.at("javascripts/firefox-dont-cache-page.js")" type="text/javascript"></script>
}
